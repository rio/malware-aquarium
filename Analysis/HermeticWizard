Hostname: WINRABB-RVU3TP4 - - starting point
Hostname: WINRABB-DA3OGU0  10.244.0.158


# Hostname: WINRABB-RVU3TP4 10.244.0.157


2022-07-01 18:30:29 OriginalFileName: REGSVR32.EXE\r\nCommandLine:  /i /s .\\a259e9b0acf375a8bef8dbc27a8a1996ee02a56889cba07ef58c49185ab033ec.dll\r\nCurrentDirectory: C:\\Users\\admin\\Downloads\\Recent\\\r\nUser: WINRABB-RVU3TP4\\admin\r\


2022-07-01 18:30:32 Network connection detected:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:30:29.012\r\nProcessGuid: {6fd3dc21-2124-62bf-4701-000000000500}\r\nProcessId: 756\r\nImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nUser: WINRABB-RVU3TP4\\admin\r\nProtocol: tcp\r\nInitiated: true\r\nSourceIsIpv6: false\r\nSourceIp: 10.244.0.157\r\nSourceHostname: WINRABB-RVU3TP4.home.arpa\r\nSourcePort: 50017\r\nSourcePortName: -\r\nDestinationIsIpv6: false\r\nDestinationIp: 10.244.0.158\r\nDestinationHostname: WINRABB-DA3OGU0\r\nDestinationPort: 445\r\nDestinationPortName: microsoft-ds

2022-07-01 18:30:36 Image: C:\\Users\\admin\\Downloads\\Recent\\cehwda.ocx\r\nFileVersion: -\r\nDescription: -\r\nProduct: -\r\nCompany: -\r\nOriginalFileName: -\r\nCommandLine: C:\\Users\\admin\\Downloads\\Recent\\cehwda.ocx \r\nCurrentDirectory: C:\\Users\\admin\\Downloads\\Recent\\\ ParentImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nParentCommandLine:  /i /s .\\a259e9b0acf375a8bef8dbc27a8a1996ee02a56889cba07ef58c49185ab033ec.dll 


2022-07-01 18:30:36 File created:\r\nRuleName: Downloads\r\nUtcTime: 2022-07-01 16:30:36.054\r\nProcessGuid: {6fd3dc21-2124-62bf-4701-000000000500}\r\nProcessId: 756\r\nImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nTargetFilename: C:\\Users\\admin\\Downloads\\Recent\\cehwda.ocx\  - Event ID 11 created



2022-07-01 18:30:36 Image: C:\\Users\\admin\\Downloads\\Recent\\cehwda.ocx\r\nFileVersion: -\r\nDescription: -\r\nProduct: -\r\nCompany: -\r\nOriginalFileName: -\r\nCommandLine: C:\\Users\\admin\\Downloads\\Recent\\cehwda.ocx \r\nCurrentDirectory: C:\\Users\\admin\\Downloads\\Recent\\\ ParentImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nParentCommandLine:  /i /s .\\a259e9b0acf375a8bef8dbc27a8a1996ee02a56889cba07ef58c49185ab033ec.dll

2022-07-01 18:30:36	
{"ProviderName":"Microsoft-Windows-Sysmon","ProviderGuid":"{5770385F-C22A-43E0-BF4C-06F5698FFBD9}","Qualifiers":"","EventID":11,"Version":2,"Level":4,"Task":11,"Opcode":0,"Keywords":"0x8000000000000000","TimeCreated":"2022-07-01 16:30:36 +0000","EventRecordID":110107,"ActivityID":"","RelatedActivityID":"","ProcessID":3352,"ThreadID":4168,"Channel":"Microsoft-Windows-Sysmon/Operational","Computer":"WINRABB-RVU3TP4","UserID":"S-1-5-18","Message":"File created:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:30:36.241\r\nProcessGuid: {6fd3dc21-212c-62bf-4801-000000000500}\r\nProcessId: 6532\r\nImage: C:\\Users\\admin\\Downloads\\Recent\\cehwda.ocx\r\nTargetFilename: C:\\Windows\\System32\\drivers\\pvdr.sys\r\nCreationUtcTime: 2022-07-01 16:30:36.241\r\nUser: WINRABB-RVU3TP4\\admin","StringInserts":["-","2022-07-01 16:30:36.241","{6FD3DC21-212C-62BF-4801-000000000500}",6532,"C:\\Users\\admin\\Downloads\\Recent\\cehwda.ocx","C:\\Windows\\System32\\drivers\\pvdr.sys","2022-07-01 16:30:36.241","WINRABB-RVU3TP4\\admin"]}

              This file is identified as a 32-bit HermeticWiper. The resource section of the HermeticWiper is embedded with four SZDD compressed driver files as displayed in Figure 1. Depending on the OS major version and system architecture type (32-bit/64-bit), the corresponding SZDD compressed file will be extracted into the System32 directory and expanded to a driver file <random-2-characters>dr.sys (Figures 2-4). The expanded file is a copy of the EaseUs Partition Manager (epmntdrv.sys). The wiper enables SeLoadDriverPrivilege and registers the driver as a system service. The new system service starts immediately and the driver process runs in memory. Then the wiper immediately removes the following registry key and deletes the SZDD file and the expanded driver file from System32 in order to remove its tracks on the victim's system.

              https://www.cisa.gov/uscert/ncas/analysis-reports/ar22-115a



2022-07-01 18:31:13	"Network connection detected:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:34:18.016\r\nProcessGuid: {6fd3dc21-2124-62bf-4701-000000000500}\r\nProcessId: 756\r\nImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nUser: WINRABB-RVU3TP4\\admin\r\nProtocol: tcp\r\nInitiated: true\r\nSourceIsIpv6: false\r\nSourceIp: 10.244.0.157\r\nSourceHostname: WINRABB-RVU3TP4.home.arpa\r\nSourcePort: 50089\r\nSourcePortName: -\r\nDestinationIsIpv6: false\r\nDestinationIp: 10.244.0.158\r\nDestinationHostname: WINRABB-DA3OGU0\r\nDestinationPort: 445\r\nDestinationPortName: microsoft-ds"

2022-07-01 18:34:48	"Network connection detected:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:34:45.390\r\nProcessGuid: {6fd3dc21-2124-62bf-4701-000000000500}\r\nProcessId: 756\r\nImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nUser: WINRABB-RVU3TP4\\admin\r\nProtocol: tcp\r\nInitiated: true\r\nSourceIsIpv6: false\r\nSourceIp: 10.244.0.157\r\nSourceHostname: WINRABB-RVU3TP4.home.arpa\r\nSourcePort: 50101\r\nSourcePortName: -\r\nDestinationIsIpv6: false\r\nDestinationIp: 10.244.0.158\r\nDestinationHostname: WINRABB-DA3OGU0\r\nDestinationPort: 445\r\nDestinationPortName: microsoft-ds"

2022-07-01 18:35:34  C:\\Windows\\SysWOW64\\regsvr32.exe\r\nTargetFilename: C:\\Users\\admin\\Downloads\\Recent\\cchebs.ocx\r\nCreationUtcTime: 2022-07-01 16:35:34.547 File created:\r\nRuleName: Downloads\r\nUtcTime: 2022-07-01 16:35:34.547\r\nProcessGuid: {6fd3dc21-2124-62bf-4701-000000000500}\r\nProcessId: 756\r\nImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nTargetFilename: C:\\Users\\admin\\Downloads\\Recent\\cchebs.ocx\r\nCreationUtcTime: 2022-07-01 16:35:34.547\r\nUser: WINRABB-RVU3TP4\\admin"

2022-07-01 18:35:35 nCommandLine: C:\\Windows\\system32\\rundll32.exe \"C:\\Users\\admin\\Downloads\\Recent\\cchebs.ocx\" #1 -s \"C:\\Users\\admin\\Downloads\\Recent\\a259e9b0acf375a8bef8dbc27a8a1996ee02a56889cba07ef58c49185ab033ec.dll\" -i 10.244.0.158\r\nCurrentDirectory: C:\\Users\\admin\\Downloads\\Recent\\\ - 	22

2022-07-01 18:35:37 Dns query:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:35:35.207\r\nProcessGuid: {6fd3dc21-2256-62bf-4b01-000000000500}\r\nProcessId: 3248\r\nQueryName: WINRABB-DA3OGU0\r\nQueryStatus: 0\r\nQueryResults: 10.244.0.158;\r\nImage: C:\\Windows\\SysWOW64\\rundll32.exe\r\nUser: WINRABB-RVU3TP4\\admin

2022-07-01 18:35:38	"Network connection detected:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:35:35.336\r\nProcessGuid: {6fd3dc21-2256-62bf-4b01-000000000500}\r\nProcessId: 3248\r\nImage: C:\\Windows\\SysWOW64\\rundll32.exe\r\nUser: WINRABB-RVU3TP4\\admin\r\nProtocol: tcp\r\nInitiated: true\r\nSourceIsIpv6: false\r\nSourceIp: 10.244.0.157\r\nSourceHostname: WINRABB-RVU3TP4.home.arpa\r\nSourcePort: 50108\r\nSourcePortName: -\r\nDestinationIsIpv6: false\r\nDestinationIp: 10.244.0.158\r\nDestinationHostname: WINRABB-DA3OGU0\r\nDestinationPort: 49973\r\nDestinationPortName: -"

2022-07-01 18:37:04 A privileged service was called.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tWINRABB-RVU3TP4$\r\n\tAccount Domain:\t\tWORKGROUP\r\n\tLogon ID:\t\t0x3E7\r\n\r\nService:\r\n\tServer:\tNT Local Security Authority / Authentication Service\r\n\tService Name:\tLsaRegisterLogonProcess()\r\n\r\nProcess:\r\n\tProcess ID:\t0x2b4\r\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\r\n\r\nService Request Information:\r\n\tPrivileges:\t\tSeTcbPrivilege"  - Security

2022-07-01 18:38:18 Network connection detected:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:38:15.374\r\nProcessGuid: {6fd3dc21-2124-62bf-4701-000000000500}\r\nProcessId: 756\r\nImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nUser: WINRABB-RVU3TP4\\admin\r\nProtocol: tcp\r\nInitiated: true\r\nSourceIsIpv6: false\r\nSourceIp: 10.244.0.157\r\nSourceHostname: WINRABB-RVU3TP4.home.arpa\r\nSourcePort: 50130\r\nSourcePortName: -\r\nDestinationIsIpv6: false\r\nDestinationIp: 10.244.0.158\r\nDestinationHostname: WINRABB-DA3OGU0\r\nDestinationPort: 445\r\nDestinationPortName: microsoft-ds"



2022-07-01 18:40:43 Network Information:\r\n\tWorkstation Name:\tWINRABB-DA3OGU0\r\n\tSource Network Address:\t10.244.0.158\r\n\tSource Port:\t\t50014\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tNtLmSsp \r\n\tAuthentication Package:\tNTLM\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\tNTLM V1\r\n\tKey Length:\t\t128\r\n\r\nT





# Second  Host WINRABB-DA3OGU0  10.244.0.158


18:35:35 A network share object was checked to see whether client can be granted desired access.\r\n\t\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-21-3275318545-1528245730-3474304344-1000\r\n\tAccount Name:\t\tadmin\r\n\tAccount Domain:\t\tWINRABB-DA3OGU0\r\n\tLogon ID:\t\t0x33EC1C\r\n\r\nNetwork Information:\t\r\n\tObject Type:\t\tFile\r\n\tSource Address:\t\t10.244.0.157\r\n\tSource Port:\t\t50105\r\n\t\r\nShare Information:\r\n\tShare Name:\t\t\\\\*\\ADMIN$\r\n\tShare Path:\t\t\\??\\C:\\Windows\r\n\tRelative Target Name:\tcA4E9E201B73F.dll\r\n\r\nAccess Request Information:\r\n\tAccess Mask:\t\t0x17019F\r\n\tAccesses:\t\tDELETE\r\n\t\t\t\tREAD_CONTROL\r\n\t\t\t\tWRITE_DAC\r\n\t\t\t\tSYNCHRONIZE\r\n\t\t\t\tReadData (or ListDirectory)\r\n\t\t\t\tWriteData (or AddFile)\r\n\t\t\t\tAppendData (or AddSubdirectory or CreatePipeInstance)\r\n\t\t\t\tReadEA\r\n\t\t\t\tWriteEA\r\n\t\t\t\tReadAttributes\r\n\t\t\t\tWriteAttributes\r\n\t\t\t\t\r\nAccess Check Results:\r\n\t-\r\n"

  18:35:35 "A network share object was checked to see whether client can be granted desired access.\r\n\t\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-21-3275318545-1528245730-3474304344-1000\r\n\tAccount Name:\t\tadmin\r\n\tAccount Domain:\t\tWINRABB-DA3OGU0\r\n\tLogon ID:\t\t0x33EC1C\r\n\r\nNetwork Information:\t\r\n\tObject Type:\t\tFile\r\n\tSource Address:\t\t10.244.0.157\r\n\tSource Port:\t\t50105\r\n\t\r\nShare Information:\r\n\tShare Name:\t\t\\\\*\\ADMIN$\r\n\tShare Path:\t\t\\??\\C:\\Windows\r\n\tRelative Target Name:\tcA4E9E201B73F.dll\r\n\r\nAccess Request Information:\r\n\tAccess Mask:\t\t0x2\r\n\tAccesses:\t\tWriteData (or AddFile)\r\n\t\t\t\t\r\nAccess Check Results:\r\n\t-\r\n"


2022-07-01 18:35:35 Windows Command Processor\r\nProduct: Microsoft® Windows® Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: C:\\Windows\\system32\\cmd.exe /c start C:\\Windows\\system32\\regsvr32.exe /s /i C:\\Windows\\cA4E9E201B73F.dll\r\nCurrentDirectory: C:\\Windows\\system32\\\r\nUser: WINRABB-DA3OGU0\\admin\r\nLogonGuid: {00263e2a-2256-62bf-43f2-330000000000}\r\nLogonId: 0x33F243\r\nTerminalSessionId: 0\r\nIntegrityLevel: High\r\nHashes: MD5=8A2122E8162DBEF04694B9C3E0B6CDEE,SHA256=B99D61D874728EDC0918CA0EB10EAB93D381E7367E377406E65963366C874450,IMPHASH=272245E2988E1E430500B852C4FB5E18\r\nParentProcessGuid: {00263e2a-2256-62bf-2101-000000000500}\r\nParentProcessId: 2440\r\nParentImage: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\r\nParentCommandLine: C:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding\r\nParentUser: NT AUTHORITY\\NETWORK SERVICE"


2022-07-01 18:35:41 "File created:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:35:40.676\r\nProcessGuid: {00263e2a-2256-62bf-2501-000000000500}\r\nProcessId: 2064\r\nImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nTargetFilename: C:\\Windows\\cwhshg.ocx\r\nCreationUtcTime: 2022-07-01 16:35:40.676\r\nUser: WINRABB-DA3OGU0\\admin"


2022-07-01 18:35:41 "File created:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:35:40.864\r\nProcessGuid: {00263e2a-225c-62bf-2601-000000000500}\r\nProcessId: 5824\r\nImage: C:\\Windows\\cwhshg.ocx\r\nTargetFilename: C:\\Windows\\System32\\drivers\\rhdr.sys\r\nCreationUtcTime: 2022-07-01 16:35:40.864\r\nUser: WINRABB-DA3OGU0\\admin"

2022-07-01 18:35:42 "A service was installed in the system.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-21-3275318545-1528245730-3474304344-1000\r\n\tAccount Name:\t\tadmin\r\n\tAccount Domain:\t\tWINRABB-DA3OGU0\r\n\tLogon ID:\t\t0x33F243\r\n\r\nService Information:\r\n\tService Name: \t\trhdr\r\n\tService File Name:\tC:\\Windows\\system32\\Drivers\\rhdr.sys\r\n\tService Type: \t\t0x1\r\n\tService Start Type:\t3\r\n\tService Account: \t\tLocalSystem"


2022-07-01 18:35:43	"Driver loaded:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:35:40.895\r\nImageLoaded: C:\\Windows\\System32\\drivers\\rhdr.sys\r\nHashes: MD5=6106653B08F4F72EEAA7F099E7C408A4,SHA256=96B77284744F8761C4F2558388E0AEE2140618B484FF53FA8B222B340D2A9C84,IMPHASH=5BBA6EB3FCCAD3D563D56EF2D7E5D5E8\r\nSigned: false\r\nSignature: -\r\nSignatureStatus: Expired"



2022-07-01 18:40:40 File created:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:40:39.895\r\nProcessGuid: {00263e2a-2256-62bf-2501-000000000500}\r\nProcessId: 2064\r\nImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nTargetFilename: C:\\Windows\\cvwpkt.ocx\r\nCreationUtcTime: 2022-07-01 16:40:39.895\r\nUser: WINRABB-DA3OGU0\\admin"

2022-07-01 18:40:40 Process Create:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:40:40.020\r\nProcessGuid: {00263e2a-2388-62bf-3301-000000000500}\r\nProcessId: 5056\r\nImage: C:\\Windows\\SysWOW64\\rundll32.exe\r\nFileVersion: 10.0.19041.746 (WinBuild.160101.0800)\r\nDescription: Windows host process (Rundll32)\r\nProduct: Microsoft® Windows® Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: RUNDLL32.EXE\r\nCommandLine: C:\\Windows\\system32\\rundll32.exe \"C:\\Windows\\cvwpkt.ocx\" #1 -s \"C:\\Windows\\cA4E9E201B73F.dll\" -i 10.244.0.157\r\nCurrentDirectory: C:\\Windows\\system32\\\r\nUser: WINRABB-DA3OGU0\\admin\r\nLogonGuid: {00263e2a-2256-62bf-43f2-330000000000}\r\nLogonId: 0x33F243\r\nTerminalSessionId: 0\r\nIntegrityLevel: High\r\nHashes: MD5=889B99C52A60DD49227C5E485A016679,SHA256=6CBE0E1F046B13B29BFA26F8B368281D2DDA7EB9B718651D5856F22CC3E02910,IMPHASH=30B6D4AA5B2B125B0ABCA749B5D12B3A\r\nParentProcessGuid: {00263e2a-2256-62bf-2501-000000000500}\r\nParentProcessId: 2064\r\nParentImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nParentCommandLine:   /s /i C:\\Windows\\cA4E9E201B73F.dll\r\nParentUser: WINRABB-DA3OGU0\\admin"


2022-07-01 18:40:50 "File created:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:40:49.098\r\nProcessGuid: {00263e2a-2256-62bf-2501-000000000500}\r\nProcessId: 2064\r\nImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nTargetFilename: C:\\Windows\\coviva.ocx\r\nCreationUtcTime: 2022-07-01 16:40:49.098\r\nUser: WINRABB-DA3OGU0\\admin"

2022-07-01 18:40:50 "Process Create:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:40:49.184\r\nProcessGuid: {00263e2a-2391-62bf-3901-000000000500}\r\nProcessId: 7524\r\nImage: C:\\Windows\\SysWOW64\\rundll32.exe\r\nFileVersion: 10.0.19041.746 (WinBuild.160101.0800)\r\nDescription: Windows host process (Rundll32)\r\nProduct: Microsoft® Windows® Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: RUNDLL32.EXE\r\nCommandLine: C:\\Windows\\system32\\rundll32.exe \"C:\\Windows\\coviva.ocx\" #1 -s \"C:\\Windows\\cA4E9E201B73F.dll\" -i 10.244.0.157\r\nCurrentDirectory: C:\\Windows\\system32\\\r\nUser: WINRABB-DA3OGU0\\admin\r\nLogonGuid: {00263e2a-2256-62bf-43f2-330000000000}\r\nLogonId: 0x33F243\r\nTerminalSessionId: 0\r\nIntegrityLevel: High\r\nHashes: MD5=889B99C52A60DD49227C5E485A016679,SHA256=6CBE0E1F046B13B29BFA26F8B368281D2DDA7EB9B718651D5856F22CC3E02910,IMPHASH=30B6D4AA5B2B125B0ABCA749B5D12B3A\r\nParentProcessGuid: {00263e2a-2256-62bf-2501-000000000500}\r\nParentProcessId: 2064\r\nParentImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nParentCommandLine:   /s /i C:\\Windows\\cA4E9E201B73F.dll\r\nParentUser: WINRABB-DA3OGU0\\admin"



# Additional data 

further research:


{host="WINRABB-RVU3TP4", channel="Microsoft-Windows-Sysmon/Operational"} !=`EventID":10` !=`GRR` !=`DestinationIp: 10.244.0.254` |=`driver`

Dns query:\r\nRuleName: -\r\nUtcTime: 2022-07-01 16:30:46.324\r\nProcessGuid: {6fd3dc21-2124-62bf-4701-000000000500}\r\nProcessId: 756\r\nQueryName: gohbcxgh\r\nQueryStatus: 9701\r\nQueryResults: -\r\nImage: C:\\Windows\\SysWOW64\\regsvr32.exe\r\nUser: WINRABB-RVU3TP4\\admin"


2022-07-01 18:53:47 FileName: RUNDLL32.EXE\r\nCommandLine: C:\\Windows\\system32\\rundll32.exe /d acproxy.dll,


2022-07-01 18:30:29  C:\\Windows\\system32\\rundll32.exe \"C:\\Users\\admin\\Downloads\\Recent\\cchebs.ocx\


2022-07-01 18:35:35

{host="WINRABB-RVU3TP4", channel="Microsoft-Windows-Sysmon/Operational"} |=`EventID":1,`

Query: {job="fluentbit"} |= `a259e9b0acf375a8bef8dbc27a8a1996ee02a56889cba07ef58c49185ab033ec`