# Get Hostname

Set-Content -Path "C:\Users\change_name.ps1" -Value "
`$number = -join ((65..90) + (97..122) | Get-Random -Count 5 | % {[char]`$_})
`$name = -join ('Desktop-' + `$number)

`$hostname_build = Get-Content 'C:\Users\h.txt'
`$hostname_now = [System.Net.Dns]::GetHostName()

if (`$hostname_build -eq `$hostname_now){
    Rename-Computer -NewName `$name
    Restart-Computer
    }
else{
    Stop-Service hostname_change
    }
"
nssm install hostname_change powershell.exe "C:\Users\change_name.ps1"
#New-Service hostname_change -BinaryPathName '"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" "C:\Users\change_name.ps1"' -StartupType "AutomaticDelayedStart"