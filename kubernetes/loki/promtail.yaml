apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  name: promtail
  namespace: kube-system
spec:
  repo: https://grafana.github.io/helm-charts
  chart: promtail
  targetNamespace: loki
    # version: 1.4.2
  valuesContent: |-
    config:
      clients:
      - url: http://loki.loki.svc.cluster.local:3100/loki/api/v1/push
    extraScrapeConfigs:
    - job_name: syslog
      syslog:
        listen_address: 0.0.0.0:1514
        labels:
          job: "syslog"

    relabel_configs:
      - source_labels: ['__syslog_message_hostname']
        target_label: 'host'

    syslogService:
      enabled: true
      type: LoadBalancer
      port: 1514
